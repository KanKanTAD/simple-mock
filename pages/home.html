<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>Simple Mock</title>
  <script src="https://lib.baomitu.com/jquery/2.2.4/jquery.min.js"></script>
  <link href="https://lib.baomitu.com/twitter-bootstrap/4.4.1/css/bootstrap.css" rel="stylesheet">
</head>
<body>
  <div class="container">
    <h1 class="display-4">Simple Mock Server</h1>
    <p class="lead">这是一个小巧灵秀的 RESTFul Mock 服务，<a href="https://github.com/fengcms/simple-mock" target="_blank">点击此处查看项目 Github</a>。</p>
    <h2>Server info</h2>
    <table class="table">
      <tbody>
        <tr>
          <th width="120">HOST</th>
          <td class="host"></td>
          <th width="120">PORT</th>
          <td class="port"></td>
        </tr>
        <tr>
          <th>API prefix</th>
          <td class="prefix"></td>
          <th>Full prefix</th>
          <td class="full"></td>
        </tr>
      </tbody>
    </table>
    <h2>Mock API list</h2>
    <table class="table">
      <thead>
        <tr>
          <th width="120" scope="col">#</th>
          <th scope="col">API</th>
          <th scope="col">Methods</th>
          <th scope="col">Name</th>
          <th scope="col">Info</th>
        </tr>
      </thead>
      <tbody class="mock-api-list"></tbody>
    </table>
    <h2>Proxy API list</h2>
    <table class="table">
      <thead>
        <tr>
          <th width="120" scope="col">#</th>
          <th scope="col">API</th>
          <th scope="col">Name</th>
          <th scope="col">Info</th>
        </tr>
      </thead>
      <tbody class="proxy-api-list"></tbody>
    </table>
    <footer class="footer">
      <hr>
      <p>
        Copyright &copy; <a href="http://www.fungleo.com" target="_blank">FungLeo</a>,
        License: MIT,
        <a href="https://github.com/fengcms/simple-mock" target="_blank">GitHub</a>
      </p>
    </footer>
  </div>
</body>
</html>
<script>
$(function () {
  function makeApiListHtml (apisArr, hasMethods) {
    let html = ''
    apisArr.forEach((i, k) => {
      html += `
      <tr>
        <th scope="row">${k + 1}</th>
        <td><a href="${i.api}" target="_blank">${i.api}</a></td>
        ${
          hasMethods
          ? `<td>${i.methods.join(', ')}</td>`
          : ''
        }
        <td>${i.name}</td>
        <td>${i.info}</td>
      </tr>
      `
    })
    return html
  }
  const ajax = $.ajax({ url: '/mock-server-info', async: false })
  const data = ajax.responseJSON
  $('.host').text(data.host)
  $('.port').text(data.port)
  $('.prefix').text(data.prefix)
  $('.full').text(location.origin + data.prefix)
  $('.mock-api-list').html(makeApiListHtml(data.mockApis, true))
  $('.proxy-api-list').html(makeApiListHtml(data.proxyApis))
})
</script>
